take each method and convert to current sha based approach

staging should only happen once

